<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>Variable System Guide - BoxMux</title>
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Variable System Guide - BoxMux | BoxMux</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Variable System Guide - BoxMux" />
<meta name="author" content="Bahram Joharshamshiri" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A YAML-driven terminal UI framework for creating rich, interactive CLI applications and dashboards." />
<meta property="og:description" content="A YAML-driven terminal UI framework for creating rich, interactive CLI applications and dashboards." />
<link rel="canonical" href="http://localhost:4000/variables.html" />
<meta property="og:url" content="http://localhost:4000/variables.html" />
<meta property="og:site_name" content="BoxMux" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Variable System Guide - BoxMux" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Bahram Joharshamshiri"},"description":"A YAML-driven terminal UI framework for creating rich, interactive CLI applications and dashboards.","headline":"Variable System Guide - BoxMux","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/boxmux-logo.png"},"name":"Bahram Joharshamshiri"},"url":"http://localhost:4000/variables.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <nav class="navbar">
      <div class="nav-container">
        <div class="nav-brand">
          <a href="/">
            <span>BoxMux</span>
          </a>
        </div>
        <div class="nav-menu">
          <a href="/" class="nav-link">Home</a>
          <a href="/user-guide" class="nav-link">Get Started</a>
          <a href="/configuration" class="nav-link">Configuration</a>
          <a href="/api" class="nav-link">API Reference</a>
          <a href="/variables" class="nav-link">Variables</a>
          <a href="/troubleshooting" class="nav-link">Help</a>
          <a href="https://github.com/jowharshamshiri/boxmux" class="nav-link github-link" target="_blank">
            GitHub
          </a>
        </div>
        <div class="nav-toggle">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </nav>

    <main class="main-content">
      
        <div class="doc-content">
          <h1 id="boxmux-variable-system-guide">BoxMux Variable System Guide</h1>

<p>The BoxMux Variable System enables dynamic configuration, template-driven interfaces, and environment-specific deployments through hierarchical variable resolution.</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#variable-syntax">Variable Syntax</a></li>
  <li><a href="#hierarchical-precedence">Hierarchical Precedence</a></li>
  <li><a href="#practical-examples">Practical Examples</a></li>
  <li><a href="#advanced-patterns">Advanced Patterns</a></li>
  <li><a href="#best-practices">Best Practices</a></li>
  <li><a href="#troubleshooting">Troubleshooting</a></li>
</ul>

<h2 id="overview">Overview</h2>

<p>BoxMux variables provide these capabilities:</p>

<ul>
  <li>Create reusable configurations that adapt to different environments</li>
  <li>Reduce duplication through hierarchical inheritance</li>
  <li>Enable template-driven deployments with dynamic content</li>
  <li>Integrate with existing environment variables</li>
  <li>Provide fallback values for robust configuration management</li>
</ul>

<h2 id="variable-syntax">Variable Syntax</h2>

<h3 id="basic-patterns">Basic Patterns</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c1"># Standard variable substitution</span>
<span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${VARIABLE_NAME}'</span>

<span class="c1"># Variable with default value</span>
<span class="na">content</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${DATABASE_HOST:localhost}'</span>

<span class="c1"># Variable with empty default</span>
<span class="na">script</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Value:</span><span class="nv"> </span><span class="s">${OPTIONAL_VAR:}"'</span><span class="pi">]</span>

<span class="c1"># Legacy environment variable support</span>
<span class="na">command</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$HOME/scripts/deploy.sh'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="supported-fields">Supported Fields</h3>

<p>Variables work in all string and string array fields:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">dynamic_muxbox'</span>
  <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE_NAME}</span><span class="nv"> </span><span class="s">Monitor'</span>          <span class="c1"># MuxBox titles</span>
  <span class="na">content</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Status:</span><span class="nv"> </span><span class="s">${SERVICE_STATUS}'</span>      <span class="c1"># MuxBox content</span>
  <span class="na">script</span><span class="pi">:</span>                                   <span class="c1"># Script commands</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">systemctl</span><span class="nv"> </span><span class="s">status</span><span class="nv"> </span><span class="s">${SERVICE_NAME}'</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">journalctl</span><span class="nv"> </span><span class="s">-u</span><span class="nv"> </span><span class="s">${SERVICE_NAME}</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">10'</span>
  <span class="na">redirect_output</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE_NAME}_logs'</span>   <span class="c1"># Output redirection</span>
  <span class="na">choices</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">content</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Restart</span><span class="nv"> </span><span class="s">${SERVICE_NAME}'</span>    <span class="c1"># Choice labels</span>
      <span class="na">script</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">systemctl</span><span class="nv"> </span><span class="s">restart</span><span class="nv"> </span><span class="s">${SERVICE_NAME}'</span><span class="pi">]</span> <span class="c1"># Choice scripts</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="hierarchical-precedence">Hierarchical Precedence</h2>

<p>Variables are resolved in strict hierarchical order, allowing fine-grained control:</p>

<h3 id="precedence-order-highest-to-lowest">Precedence Order (Highest to Lowest)</h3>

<ol>
  <li><strong>MuxBox-specific variables</strong> - Most granular control</li>
  <li><strong>Parent muxbox variables</strong> - Inherited through muxbox hierarchy</li>
  <li><strong>Layout-level variables</strong> - Layout scope (future enhancement)</li>
  <li><strong>Application-global variables</strong> - App-wide scope</li>
  <li><strong>Environment variables</strong> - System fallback</li>
  <li><strong>Default values</strong> - Built-in fallbacks</li>
</ol>

<h3 id="inheritance-example">Inheritance Example</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">ENVIRONMENT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">production"</span>        <span class="c1"># App-level: available everywhere</span>
    <span class="na">DEFAULT_PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">8080"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">services'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">web_tier'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">TIER</span><span class="pi">:</span> <span class="s2">"</span><span class="s">frontend"</span>         <span class="c1"># Parent level: inherited by children</span>
            <span class="na">DEFAULT_PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">80"</span>       <span class="c1"># Overrides app-level DEFAULT_PORT</span>
          <span class="na">children</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">nginx'</span>
              <span class="na">variables</span><span class="pi">:</span>
                <span class="na">SERVICE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">nginx"</span>     <span class="c1"># Child level: highest precedence</span>
                <span class="na">PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">443"</span>          <span class="c1"># Overrides parent DEFAULT_PORT</span>
              <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE}</span><span class="nv"> </span><span class="s">(${TIER})</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">${ENVIRONMENT}'</span>
              <span class="c1"># Resolves to: "nginx (frontend) - production"</span>
              <span class="na">script</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Starting</span><span class="nv"> </span><span class="s">${SERVICE}</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">port</span><span class="nv"> </span><span class="s">${PORT:${DEFAULT_PORT}}"'</span>
                <span class="c1"># Resolves to: "Starting nginx on port 443"</span>
                
            <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">apache'</span>
              <span class="na">variables</span><span class="pi">:</span>
                <span class="na">SERVICE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">apache2"</span>
              <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE}</span><span class="nv"> </span><span class="s">(${TIER})</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">${ENVIRONMENT}'</span>
              <span class="c1"># Resolves to: "apache2 (frontend) - production"</span>
              <span class="na">script</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Starting</span><span class="nv"> </span><span class="s">${SERVICE}</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">port</span><span class="nv"> </span><span class="s">${PORT:${DEFAULT_PORT}}"'</span>
                <span class="c1"># Resolves to: "Starting apache2 on port 80" (uses parent DEFAULT_PORT)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="practical-examples">Practical Examples</h2>

<h3 id="environment-specific-configuration">Environment-Specific Configuration</h3>

<p>Create a single configuration that works across multiple environments:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="c1"># Override these via environment variables for different deployments</span>
    <span class="na">ENVIRONMENT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">development"</span>
    <span class="na">API_BASE_URL</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://localhost:3000"</span>
    <span class="na">DATABASE_URL</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgres://localhost:5432/myapp_dev"</span>
    <span class="na">LOG_LEVEL</span><span class="pi">:</span> <span class="s2">"</span><span class="s">debug"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">deployment_status'</span>
      <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Deployment</span><span class="nv"> </span><span class="s">Status</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">${ENVIRONMENT}'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">api_health'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">SERVICE_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">API</span><span class="nv"> </span><span class="s">Gateway"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE_NAME}</span><span class="nv"> </span><span class="s">Health</span><span class="nv"> </span><span class="s">Check'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Environment:</span><span class="nv"> </span><span class="s">${ENVIRONMENT}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Checking</span><span class="nv"> </span><span class="s">API</span><span class="nv"> </span><span class="s">at:</span><span class="nv"> </span><span class="s">${API_BASE_URL}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">curl</span><span class="nv"> </span><span class="s">-f</span><span class="nv"> </span><span class="s">${API_BASE_URL}/health</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">echo</span><span class="nv"> </span><span class="s">"API</span><span class="nv"> </span><span class="s">Down"'</span>
            
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">database_status'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">SERVICE_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Database"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE_NAME}</span><span class="nv"> </span><span class="s">Connection'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Testing</span><span class="nv"> </span><span class="s">connection</span><span class="nv"> </span><span class="s">to:</span><span class="nv"> </span><span class="s">${DATABASE_URL}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">pg_isready</span><span class="nv"> </span><span class="s">-d</span><span class="nv"> </span><span class="s">"${DATABASE_URL}"</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">echo</span><span class="nv"> </span><span class="s">"Connected"</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">echo</span><span class="nv"> </span><span class="s">"Failed"'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Deploy to different environments:</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="c"># Development</span>
./boxmux my-config.yaml

<span class="c"># Staging</span>
<span class="nv">ENVIRONMENT</span><span class="o">=</span><span class="s2">"staging"</span> <span class="nv">API_BASE_URL</span><span class="o">=</span><span class="s2">"https://api-staging.company.com"</span> <span class="se">\</span>
<span class="nv">DATABASE_URL</span><span class="o">=</span><span class="s2">"postgres://staging-db:5432/myapp"</span> ./boxmux my-config.yaml

<span class="c"># Production</span>
<span class="nv">ENVIRONMENT</span><span class="o">=</span><span class="s2">"production"</span> <span class="nv">API_BASE_URL</span><span class="o">=</span><span class="s2">"https://api.company.com"</span> <span class="se">\</span>
<span class="nv">DATABASE_URL</span><span class="o">=</span><span class="s2">"postgres://prod-db:5432/myapp"</span> <span class="nv">LOG_LEVEL</span><span class="o">=</span><span class="s2">"info"</span> ./boxmux my-config.yaml
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="multi-service-monitoring-dashboard">Multi-Service Monitoring Dashboard</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">MONITORING_USER</span><span class="pi">:</span> <span class="s2">"</span><span class="s">monitor"</span>
    <span class="na">SSH_KEY_PATH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">~/.ssh/monitoring_key"</span>
    <span class="na">LOG_RETENTION_DAYS</span><span class="pi">:</span> <span class="s2">"</span><span class="s">7"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">infrastructure_overview'</span>
      <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Infrastructure</span><span class="nv"> </span><span class="s">Monitoring'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="c1"># Web servers section</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">web_servers'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">SERVER_TYPE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">web"</span>
            <span class="na">DEFAULT_PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">80"</span>
          <span class="na">children</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">web1'</span>
              <span class="na">variables</span><span class="pi">:</span>
                <span class="na">HOSTNAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">web1.company.com"</span>
                <span class="na">SERVICE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">nginx"</span>
                <span class="na">PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">443"</span>
              <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE}@${HOSTNAME}:${PORT}'</span>
              <span class="na">script</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">ssh</span><span class="nv"> </span><span class="s">-i</span><span class="nv"> </span><span class="s">${SSH_KEY_PATH}</span><span class="nv"> </span><span class="s">${MONITORING_USER}@${HOSTNAME}</span><span class="nv"> </span><span class="s">"systemctl</span><span class="nv"> </span><span class="s">is-active</span><span class="nv"> </span><span class="s">${SERVICE}"'</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">ssh</span><span class="nv"> </span><span class="s">-i</span><span class="nv"> </span><span class="s">${SSH_KEY_PATH}</span><span class="nv"> </span><span class="s">${MONITORING_USER}@${HOSTNAME}</span><span class="nv"> </span><span class="s">"ss</span><span class="nv"> </span><span class="s">-tulpn</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">grep</span><span class="nv"> </span><span class="s">:${PORT}"'</span>
                
            <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">web2'</span>
              <span class="na">variables</span><span class="pi">:</span>
                <span class="na">HOSTNAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">web2.company.com"</span>
                <span class="na">SERVICE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">apache2"</span>
                <span class="c1"># PORT not defined, will use parent DEFAULT_PORT (80)</span>
              <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE}@${HOSTNAME}:${PORT:${DEFAULT_PORT}}'</span>
              <span class="na">script</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">ssh</span><span class="nv"> </span><span class="s">-i</span><span class="nv"> </span><span class="s">${SSH_KEY_PATH}</span><span class="nv"> </span><span class="s">${MONITORING_USER}@${HOSTNAME}</span><span class="nv"> </span><span class="s">"systemctl</span><span class="nv"> </span><span class="s">is-active</span><span class="nv"> </span><span class="s">${SERVICE}"'</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">ssh</span><span class="nv"> </span><span class="s">-i</span><span class="nv"> </span><span class="s">${SSH_KEY_PATH}</span><span class="nv"> </span><span class="s">${MONITORING_USER}@${HOSTNAME}</span><span class="nv"> </span><span class="s">"ss</span><span class="nv"> </span><span class="s">-tulpn</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">grep</span><span class="nv"> </span><span class="s">:${PORT:${DEFAULT_PORT}}"'</span>
                
        <span class="c1"># Database servers section</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">database_servers'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">SERVER_TYPE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">database"</span>
            <span class="na">DEFAULT_PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">5432"</span>
          <span class="na">children</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">db_primary'</span>
              <span class="na">variables</span><span class="pi">:</span>
                <span class="na">HOSTNAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">db1.company.com"</span>
                <span class="na">ROLE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">primary"</span>
                <span class="na">SERVICE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgresql"</span>
              <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE}</span><span class="nv"> </span><span class="s">${ROLE}@${HOSTNAME}'</span>
              <span class="na">script</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">ssh</span><span class="nv"> </span><span class="s">-i</span><span class="nv"> </span><span class="s">${SSH_KEY_PATH}</span><span class="nv"> </span><span class="s">${MONITORING_USER}@${HOSTNAME}</span><span class="nv"> </span><span class="s">"sudo</span><span class="nv"> </span><span class="s">-u</span><span class="nv"> </span><span class="s">postgres</span><span class="nv"> </span><span class="s">psql</span><span class="nv"> </span><span class="s">-c</span><span class="nv"> </span><span class="s">\"SELECT</span><span class="nv"> </span><span class="s">version();\""'</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">ssh</span><span class="nv"> </span><span class="s">-i</span><span class="nv"> </span><span class="s">${SSH_KEY_PATH}</span><span class="nv"> </span><span class="s">${MONITORING_USER}@${HOSTNAME}</span><span class="nv"> </span><span class="s">"sudo</span><span class="nv"> </span><span class="s">-u</span><span class="nv"> </span><span class="s">postgres</span><span class="nv"> </span><span class="s">psql</span><span class="nv"> </span><span class="s">-c</span><span class="nv"> </span><span class="s">\"SELECT</span><span class="nv"> </span><span class="s">pg_is_in_recovery();\""'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="template-driven-deployment-pipeline">Template-Driven Deployment Pipeline</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre></td><td class="rouge-code"><pre><span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">DEPLOYMENT_BRANCH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">main"</span>
    <span class="na">DOCKER_REGISTRY</span><span class="pi">:</span> <span class="s2">"</span><span class="s">registry.company.com"</span>
    <span class="na">NAMESPACE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">default"</span>
    <span class="na">REPLICAS</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">deployment_pipeline'</span>
      <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Deployment</span><span class="nv"> </span><span class="s">Pipeline</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">${DEPLOYMENT_BRANCH}'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">build_stage'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">STAGE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">build"</span>
            <span class="na">IMAGE_TAG</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DEPLOYMENT_BRANCH}-${BUILD_ID:latest}"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${STAGE}</span><span class="nv"> </span><span class="s">Stage'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Building</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">branch:</span><span class="nv"> </span><span class="s">${DEPLOYMENT_BRANCH}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">git</span><span class="nv"> </span><span class="s">checkout</span><span class="nv"> </span><span class="s">${DEPLOYMENT_BRANCH}'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">docker</span><span class="nv"> </span><span class="s">build</span><span class="nv"> </span><span class="s">-t</span><span class="nv"> </span><span class="s">${DOCKER_REGISTRY}/myapp:${IMAGE_TAG}</span><span class="nv"> </span><span class="s">.'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">docker</span><span class="nv"> </span><span class="s">push</span><span class="nv"> </span><span class="s">${DOCKER_REGISTRY}/myapp:${IMAGE_TAG}'</span>
            
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">deploy_frontend'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">COMPONENT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">frontend"</span>
            <span class="na">PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3000"</span>
            <span class="na">HEALTH_PATH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Deploy</span><span class="nv"> </span><span class="s">${COMPONENT}'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Deploying</span><span class="nv"> </span><span class="s">${COMPONENT}</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">${NAMESPACE}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">kubectl</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">image</span><span class="nv"> </span><span class="s">deployment/${COMPONENT}</span><span class="nv"> </span><span class="s">${COMPONENT}=${DOCKER_REGISTRY}/myapp:${IMAGE_TAG:latest}</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">${NAMESPACE}'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">kubectl</span><span class="nv"> </span><span class="s">scale</span><span class="nv"> </span><span class="s">deployment/${COMPONENT}</span><span class="nv"> </span><span class="s">--replicas=${REPLICAS}</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">${NAMESPACE}'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">kubectl</span><span class="nv"> </span><span class="s">rollout</span><span class="nv"> </span><span class="s">status</span><span class="nv"> </span><span class="s">deployment/${COMPONENT}</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">${NAMESPACE}'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Health</span><span class="nv"> </span><span class="s">check:</span><span class="nv"> </span><span class="s">http://${COMPONENT}:${PORT}${HEALTH_PATH}"'</span>
            
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">deploy_backend'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">COMPONENT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">backend"</span>
            <span class="na">PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">8080"</span>
            <span class="na">HEALTH_PATH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/api/health"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Deploy</span><span class="nv"> </span><span class="s">${COMPONENT}'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Deploying</span><span class="nv"> </span><span class="s">${COMPONENT}</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">${NAMESPACE}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">kubectl</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">image</span><span class="nv"> </span><span class="s">deployment/${COMPONENT}</span><span class="nv"> </span><span class="s">${COMPONENT}=${DOCKER_REGISTRY}/myapp:${IMAGE_TAG:latest}</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">${NAMESPACE}'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">kubectl</span><span class="nv"> </span><span class="s">scale</span><span class="nv"> </span><span class="s">deployment/${COMPONENT}</span><span class="nv"> </span><span class="s">--replicas=${REPLICAS}</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">${NAMESPACE}'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">kubectl</span><span class="nv"> </span><span class="s">rollout</span><span class="nv"> </span><span class="s">status</span><span class="nv"> </span><span class="s">deployment/${COMPONENT}</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">${NAMESPACE}'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Health</span><span class="nv"> </span><span class="s">check:</span><span class="nv"> </span><span class="s">http://${COMPONENT}:${PORT}${HEALTH_PATH}"'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="additional-patterns">Additional Patterns</h2>

<h3 id="conditional-logic-with-defaults">Conditional Logic with Defaults</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="c1"># Use environment-specific settings with intelligent defaults</span>
<span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="c1"># Development defaults</span>
    <span class="na">DEBUG_MODE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">REPLICA_COUNT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1"</span>
    <span class="na">RESOURCE_LIMITS</span><span class="pi">:</span> <span class="s2">"</span><span class="s">false"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">app_deployment'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">application'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="c1"># Use production values if set, otherwise development defaults</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Debug</span><span class="nv"> </span><span class="s">mode:</span><span class="nv"> </span><span class="s">${DEBUG_MODE}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Replicas:</span><span class="nv"> </span><span class="s">${REPLICA_COUNT}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Resource</span><span class="nv"> </span><span class="s">limits:</span><span class="nv"> </span><span class="s">${ENABLE_RESOURCE_LIMITS:${RESOURCE_LIMITS}}"'</span>
            <span class="pi">-</span> <span class="pi">|</span>
              <span class="s">if [ "${DEBUG_MODE}" = "true" ]; then</span>
                <span class="s">echo "Running in debug mode"</span>
              <span class="s">else</span>
                <span class="s">echo "Running in production mode"</span>
              <span class="s">fi</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="dynamic-service-discovery">Dynamic Service Discovery</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">CONSUL_ENDPOINT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://consul.service.consul:8500"</span>
    <span class="na">SERVICE_DISCOVERY</span><span class="pi">:</span> <span class="s2">"</span><span class="s">consul"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">service_mesh'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">service_registry'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">QUERY_PATH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/v1/catalog/services"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Service</span><span class="nv"> </span><span class="s">Registry</span><span class="nv"> </span><span class="s">(${SERVICE_DISCOVERY})'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">curl</span><span class="nv"> </span><span class="s">-s</span><span class="nv"> </span><span class="s">${CONSUL_ENDPOINT}${QUERY_PATH}</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">jq</span><span class="nv"> </span><span class="s">"keys"'</span>
            
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">service_health'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">SERVICE_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">web-api"</span>
            <span class="na">QUERY_PATH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/v1/health/service"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE_NAME}</span><span class="nv"> </span><span class="s">Health'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">curl</span><span class="nv"> </span><span class="s">-s</span><span class="nv"> </span><span class="s">${CONSUL_ENDPOINT}${QUERY_PATH}/${SERVICE_NAME}</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">jq</span><span class="nv"> </span><span class="s">".[].Checks[].Status"'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="multi-environment-configuration-matrix">Multi-Environment Configuration Matrix</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="c1"># Base configuration</span>
    <span class="na">APP_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">myapp"</span>
    <span class="na">DEFAULT_MEMORY</span><span class="pi">:</span> <span class="s2">"</span><span class="s">512Mi"</span>
    <span class="na">DEFAULT_CPU</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0.5"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">environment_matrix'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">development'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">ENV</span><span class="pi">:</span> <span class="s2">"</span><span class="s">dev"</span>
            <span class="na">REPLICAS</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1"</span>
            <span class="na">MEMORY_LIMIT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">256Mi"</span>
            <span class="na">CPU_LIMIT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0.25"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${APP_NAME}-${ENV}</span><span class="nv"> </span><span class="s">(${REPLICAS}</span><span class="nv"> </span><span class="s">replicas)'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Environment:</span><span class="nv"> </span><span class="s">${ENV}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Resources:</span><span class="nv"> </span><span class="s">CPU=${CPU_LIMIT},</span><span class="nv"> </span><span class="s">Memory=${MEMORY_LIMIT}"'</span>
            
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">staging'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">ENV</span><span class="pi">:</span> <span class="s2">"</span><span class="s">staging"</span>
            <span class="na">REPLICAS</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2"</span>
            <span class="c1"># Uses DEFAULT_MEMORY and DEFAULT_CPU from app level</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${APP_NAME}-${ENV}</span><span class="nv"> </span><span class="s">(${REPLICAS}</span><span class="nv"> </span><span class="s">replicas)'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Environment:</span><span class="nv"> </span><span class="s">${ENV}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Resources:</span><span class="nv"> </span><span class="s">CPU=${CPU_LIMIT:${DEFAULT_CPU}},</span><span class="nv"> </span><span class="s">Memory=${MEMORY_LIMIT:${DEFAULT_MEMORY}}"'</span>
            
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">production'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">ENV</span><span class="pi">:</span> <span class="s2">"</span><span class="s">prod"</span>
            <span class="na">REPLICAS</span><span class="pi">:</span> <span class="s2">"</span><span class="s">5"</span>
            <span class="na">MEMORY_LIMIT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1Gi"</span>
            <span class="na">CPU_LIMIT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1.0"</span>
          <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${APP_NAME}-${ENV}</span><span class="nv"> </span><span class="s">(${REPLICAS}</span><span class="nv"> </span><span class="s">replicas)'</span>
          <span class="na">script</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Environment:</span><span class="nv"> </span><span class="s">${ENV}"'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Resources:</span><span class="nv"> </span><span class="s">CPU=${CPU_LIMIT},</span><span class="nv"> </span><span class="s">Memory=${MEMORY_LIMIT}"'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="best-practices">Best Practices</h2>

<h3 id="1-use-meaningful-variable-names">1. Use Meaningful Variable Names</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c1"># Good: Descriptive and scoped</span>
<span class="na">variables</span><span class="pi">:</span>
  <span class="na">DATABASE_CONNECTION_STRING</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgres://localhost:5432/myapp"</span>
  <span class="na">API_GATEWAY_ENDPOINT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://api.company.com"</span>
  <span class="na">LOG_RETENTION_DAYS</span><span class="pi">:</span> <span class="s2">"</span><span class="s">30"</span>

<span class="c1"># Avoid: Generic or ambiguous names</span>
<span class="na">variables</span><span class="pi">:</span>
  <span class="na">URL</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://api.company.com"</span>      <span class="c1"># Too generic</span>
  <span class="na">CONFIG</span><span class="pi">:</span> <span class="s2">"</span><span class="s">some_value"</span>                <span class="c1"># Unclear purpose</span>
  <span class="na">X</span><span class="pi">:</span> <span class="s2">"</span><span class="s">30"</span>                             <span class="c1"># Meaningless</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="2-provide-sensible-defaults">2. Provide Sensible Defaults</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1"># Always provide fallback values for optional configuration</span>
<span class="na">script</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Timeout:</span><span class="nv"> </span><span class="s">${REQUEST_TIMEOUT:30}s"'</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Retries:</span><span class="nv"> </span><span class="s">${MAX_RETRIES:3}"'</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Log</span><span class="nv"> </span><span class="s">level:</span><span class="nv"> </span><span class="s">${LOG_LEVEL:info}"'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="3-group-related-variables-by-scope">3. Group Related Variables by Scope</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="c1"># Global application settings</span>
    <span class="na">APP_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">myapp"</span>
    <span class="na">VERSION</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1.0.0"</span>
    <span class="na">ENVIRONMENT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">production"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">database_tier'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">postgres'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="c1"># Database-specific configuration</span>
            <span class="na">DB_HOST</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgres.internal"</span>
            <span class="na">DB_PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">5432"</span>
            <span class="na">DB_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">myapp_prod"</span>
            <span class="na">CONNECTION_POOL_SIZE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10"</span>
            
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">redis'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="c1"># Cache-specific configuration</span>
            <span class="na">REDIS_HOST</span><span class="pi">:</span> <span class="s2">"</span><span class="s">redis.internal"</span>
            <span class="na">REDIS_PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">6379"</span>
            <span class="na">REDIS_DB</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
            <span class="na">CACHE_TTL</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3600"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="4-use-environment-variables-for-secrets">4. Use Environment Variables for Secrets</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c1"># Never store secrets in YAML files</span>
<span class="c1"># Use environment variables with meaningful defaults for non-secrets</span>
<span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">DATABASE_HOST</span><span class="pi">:</span> <span class="s2">"</span><span class="s">localhost"</span>        <span class="c1"># OK: Default host</span>
    <span class="na">DATABASE_PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">5432"</span>             <span class="c1"># OK: Default port</span>
    <span class="c1"># DATABASE_PASSWORD: "secret123"  # NEVER: Use $DATABASE_PASSWORD instead</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">database_muxbox'</span>
      <span class="na">script</span><span class="pi">:</span>
        <span class="c1"># Reference secrets via environment variables</span>
        <span class="pi">-</span> <span class="s1">'</span><span class="s">psql</span><span class="nv"> </span><span class="s">-h</span><span class="nv"> </span><span class="s">${DATABASE_HOST}</span><span class="nv"> </span><span class="s">-p</span><span class="nv"> </span><span class="s">${DATABASE_PORT}</span><span class="nv"> </span><span class="s">-U</span><span class="nv"> </span><span class="s">${DATABASE_USER}</span><span class="nv"> </span><span class="s">${DATABASE_NAME}'</span>
        <span class="c1"># $DATABASE_USER and $DATABASE_PASSWORD come from environment</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="5-leverage-hierarchical-inheritance">5. Leverage Hierarchical Inheritance</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="c1"># Define common settings at higher levels, specifics at lower levels</span>
<span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">COMPANY_DOMAIN</span><span class="pi">:</span> <span class="s2">"</span><span class="s">company.com"</span>
    <span class="na">MONITORING_ENABLED</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    
  <span class="na">layouts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">microservices'</span>
      <span class="na">children</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">service_group_a'</span>
          <span class="na">variables</span><span class="pi">:</span>
            <span class="na">SERVICE_GROUP</span><span class="pi">:</span> <span class="s2">"</span><span class="s">frontend"</span>
            <span class="na">DEFAULT_PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3000"</span>
          <span class="na">children</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">react_app'</span>
              <span class="na">variables</span><span class="pi">:</span>
                <span class="na">SERVICE_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">react-ui"</span>
                <span class="c1"># Inherits: COMPANY_DOMAIN, MONITORING_ENABLED, SERVICE_GROUP, DEFAULT_PORT</span>
              <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE_NAME}</span><span class="nv"> </span><span class="s">(${SERVICE_GROUP})'</span>
              
            <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">vue_app'</span>
              <span class="na">variables</span><span class="pi">:</span>
                <span class="na">SERVICE_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">vue-dashboard"</span>
                <span class="na">PORT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3001"</span>  <span class="c1"># Overrides DEFAULT_PORT for this service</span>
              <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">${SERVICE_NAME}</span><span class="nv"> </span><span class="s">(${SERVICE_GROUP})'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="common-issues-and-solutions">Common Issues and Solutions</h3>

<h4 id="issue-variable-not-resolving">Issue: Variable Not Resolving</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c1"># Problem: Variable shows as literal text</span>
<span class="na">content</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Server:</span><span class="nv"> </span><span class="s">${SERVER_NAME}'</span>
<span class="c1"># Output: "Server: ${SERVER_NAME}"</span>

<span class="c1"># Solution 1: Check variable is defined</span>
<span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">SERVER_NAME</span><span class="pi">:</span> <span class="s2">"</span><span class="s">prod-server"</span>

<span class="c1"># Solution 2: Provide a default</span>
<span class="na">content</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Server:</span><span class="nv"> </span><span class="s">${SERVER_NAME:unknown}'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="issue-nested-variable-syntax">Issue: Nested Variable Syntax</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c1"># Problem: Attempting nested variables (not supported)</span>
<span class="na">content</span><span class="pi">:</span> <span class="s1">'</span><span class="s">User:</span><span class="nv"> </span><span class="s">${USER:${DEFAULT_USER}}'</span>
<span class="c1"># Error: "Nested variable substitution is not supported"</span>

<span class="c1"># Solution: Use simpler fallback chain</span>
<span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">DEFAULT_USER</span><span class="pi">:</span> <span class="s2">"</span><span class="s">admin"</span>
<span class="na">content</span><span class="pi">:</span> <span class="s1">'</span><span class="s">User:</span><span class="nv"> </span><span class="s">${USER:admin}'</span>  <span class="c1"># Use literal default</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="issue-environment-override-not-working">Issue: Environment Override Not Working</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c1"># Problem: YAML variable always takes precedence</span>
<span class="na">app</span><span class="pi">:</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">LOG_LEVEL</span><span class="pi">:</span> <span class="s2">"</span><span class="s">info"</span>  <span class="c1"># This overrides environment $LOG_LEVEL</span>

<span class="c1"># Solution: Only define in YAML if you want it to override environment</span>
<span class="c1"># Remove from YAML to let environment variables work:</span>
<span class="na">script</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"Log</span><span class="nv"> </span><span class="s">level:</span><span class="nv"> </span><span class="s">${LOG_LEVEL:info}"'</span>  <span class="c1"># Uses $LOG_LEVEL or "info"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="issue-special-characters-in-variable-values">Issue: Special Characters in Variable Values</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1"># Problem: Variable contains special shell characters</span>
<span class="na">variables</span><span class="pi">:</span>
  <span class="na">PASSWORD</span><span class="pi">:</span> <span class="s2">"</span><span class="s">my$ecret&amp;password"</span>
  
<span class="c1"># Solution: Quote appropriately in scripts</span>
<span class="na">script</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">mysql</span><span class="nv"> </span><span class="s">-p"${PASSWORD}"</span><span class="nv"> </span><span class="s">mydb'</span>  <span class="c1"># Quote the variable substitution</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="debugging-variable-resolution">Debugging Variable Resolution</h3>

<p>Add debug output to understand variable resolution:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">debug_muxbox'</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">LOCAL_VAR</span><span class="pi">:</span> <span class="s2">"</span><span class="s">muxbox_value"</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"===</span><span class="nv"> </span><span class="s">Variable</span><span class="nv"> </span><span class="s">Resolution</span><span class="nv"> </span><span class="s">Debug</span><span class="nv"> </span><span class="s">==="'</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"LOCAL_VAR:</span><span class="nv"> </span><span class="s">${LOCAL_VAR}"'</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"GLOBAL_VAR:</span><span class="nv"> </span><span class="s">${GLOBAL_VAR:not_set}"'</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"ENV_VAR:</span><span class="nv"> </span><span class="s">${HOME:not_set}"'</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"WITH_DEFAULT:</span><span class="nv"> </span><span class="s">${UNDEFINED_VAR:default_value}"'</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">echo</span><span class="nv"> </span><span class="s">"================================"'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This will help you understand how variables are being resolved in your specific configuration.</p>

        </div>
      
    </main>

    <footer class="footer">
      <div class="footer-container">
        <div class="footer-section">
          <h4>BoxMux</h4>
          <p>A YAML-driven terminal UI framework for creating rich, interactive CLI applications and dashboards.</p>
          <div class="social-links">
            <a href="https://github.com/jowharshamshiri/boxmux" target="_blank">
              GitHub
            </a>
            <a href="https://crates.io/crates/boxmux" target="_blank">
              crates.io
            </a>
          </div>
        </div>
        <div class="footer-section">
          <h4>Documentation</h4>
          <ul>
            <li><a href="/user-guide">Getting Started</a></li>
            <li><a href="/configuration">Configuration Guide</a></li>
            <li><a href="/api">API Reference</a></li>
            <li><a href="/variables">Variable System</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Community</h4>
          <ul>
            <li><a href="https://github.com/jowharshamshiri/boxmux/issues" target="_blank">Report Issues</a></li>
            <li><a href="https://github.com/jowharshamshiri/boxmux/discussions" target="_blank">Discussions</a></li>
            <li><a href="/roadmap">Roadmap</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Installation</h4>
          <div class="install-snippet">
            <code>cargo install boxmux</code>
            <button class="copy-btn" onclick="copyToClipboard('cargo install boxmux')">
              Copy
            </button>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 BoxMux. Licensed under MIT License.</p>
      </div>
    </footer>

    <script>
      // Mobile menu toggle
      const navToggle = document.querySelector('.nav-toggle');
      const navMenu = document.querySelector('.nav-menu');
      
      navToggle.addEventListener('click', () => {
        navMenu.classList.toggle('active');
      });

      // Copy to clipboard
      function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
          const btn = event.target.closest('.copy-btn');
          btn.textContent = 'Copied';
          setTimeout(() => {
            btn.textContent = 'Copy';
          }, 2000);
        });
      }

      // Smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
          });
        });
      });
    </script>
  </body>
</html>